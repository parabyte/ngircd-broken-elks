diff --git a/src/ipaddr/ng_ipaddr.h b/src/ipaddr/ng_ipaddr.h
index f8409de9..c85fa362 100644
--- a/src/ipaddr/ng_ipaddr.h
+++ b/src/ipaddr/ng_ipaddr.h
@@ -23,6 +23,13 @@
 # define PF_INET AF_INET
 #endif
 
+#ifndef HAVE_GETADDRINFO
+struct in_addr;
+extern int inet_aton(const char *, struct in_addr *);
+extern unsigned long inet_addr(const char *);
+extern char *inet_ntoa(struct in_addr);
+#endif
+
 
 #ifdef WANT_IPV6
 #define NG_INET_ADDRSTRLEN	INET6_ADDRSTRLEN
diff --git a/src/ngircd/client.c b/src/ngircd/client.c
index 70ac28f0..c5dde398 100644
--- a/src/ngircd/client.c
+++ b/src/ngircd/client.c
@@ -25,7 +25,12 @@
 #include <string.h>
 #include <strings.h>
 #include <time.h>
+#ifdef __WATCOMC__
+extern int gethostname(char *, int);
+#endif
+#ifndef NGIRCD_DISABLE_RESOLVER
 #include <netdb.h>
+#endif
 
 #include "conn.h"
 #include "ngircd.h"
@@ -71,8 +76,6 @@ static void cb_introduceClient PARAMS((CLIENT *Client, CLIENT *Prefix,
 GLOBAL void
 Client_Init( void )
 {
-	struct hostent *h;
-
 	This_Server = New_Client_Struct( );
 	if( ! This_Server )
 	{
@@ -89,11 +92,18 @@ Client_Init( void )
 	This_Server->mytoken = 1;
 	This_Server->hops = 0;
 
+#ifndef NGIRCD_DISABLE_RESOLVER
 	gethostname( This_Server->host, CLIENT_HOST_LEN );
 	if (Conf_DNS) {
+		struct hostent *h;
+
 		h = gethostbyname( This_Server->host );
-		if (h) strlcpy(This_Server->host, h->h_name, sizeof(This_Server->host));
+		if (h != NULL && h->h_name != NULL)
+			strlcpy(This_Server->host, h->h_name, sizeof(This_Server->host));
 	}
+#else
+	strlcpy(This_Server->host, Conf_ServerName, sizeof(This_Server->host));
+#endif
 	Client_SetID( This_Server, Conf_ServerName );
 	Client_SetInfo( This_Server, Conf_ServerInfo );
 
diff --git a/src/ngircd/conf-ssl.h b/src/ngircd/conf-ssl.h
index a8896a1f..1d373c32 100644
--- a/src/ngircd/conf-ssl.h
+++ b/src/ngircd/conf-ssl.h
@@ -10,7 +10,7 @@
  * SSL related definitions
  */
 
-#ifdef HAVE_LIBSSL
+#if defined(HAVE_LIBSSL) && !defined(NGIRCD_DISABLE_SSL)
 #define SSL_SUPPORT
 #include <openssl/ssl.h>
 #if OPENSSL_VERSION_NUMBER < 0x10100000L
@@ -18,8 +18,10 @@
 #define OPENSSL_VERSION SSLEAY_VERSION
 #endif
 #endif
-#ifdef HAVE_LIBGNUTLS
+#if defined(HAVE_LIBGNUTLS) && !defined(NGIRCD_DISABLE_SSL)
+#ifndef SSL_SUPPORT
 #define SSL_SUPPORT
+#endif
 #include <gnutls/gnutls.h>
 #ifndef LIBGNUTLS_VERSION_MAJOR
 #define gnutls_certificate_credentials_t gnutls_certificate_credentials
diff --git a/src/ngircd/conf.c b/src/ngircd/conf.c
index 6cf4fe03..67330e76 100644
--- a/src/ngircd/conf.c
+++ b/src/ngircd/conf.c
@@ -33,7 +33,12 @@
 #include <grp.h>
 #include <sys/types.h>
 #include <dirent.h>
+#ifdef __WATCOMC__
+extern int gethostname(char *, int);
+#endif
+#ifndef NGIRCD_DISABLE_RESOLVER
 #include <netdb.h>
+#endif
 
 #ifdef HAVE_SYS_RESOURCE_H
 #	include <sys/resource.h>
@@ -811,7 +816,11 @@ Set_Defaults(bool InitServers)
 	Conf_ConnectIPv6 = false;
 #endif
 	strcpy(Conf_DefaultUserModes, "");
+#ifdef NGIRCD_DISABLE_RESOLVER
+	Conf_DNS = false;
+#else
 	Conf_DNS = true;
+#endif
 #ifdef IDENTAUTH
 	Conf_Ident = true;
 #else
@@ -1679,8 +1688,16 @@ Handle_OPTIONS(const char *File, int Line, char *Var, char *Arg)
 		return;
 	}
 	if (strcasecmp(Var, "DNS") == 0) {
+#ifdef NGIRCD_DISABLE_RESOLVER
+		Config_Error(LOG_WARNING,
+			     "%s, line %d: DNS lookups are disabled on this build; ignoring \"DNS\" option.",
+			     File, Line);
+		Conf_DNS = false;
+		return;
+#else
 		Conf_DNS = Check_ArgIsTrue(Arg);
 		return;
+#endif
 	}
 	if (strcasecmp(Var, "Ident") == 0) {
 		Conf_Ident = Check_ArgIsTrue(Arg);
@@ -2111,7 +2128,9 @@ Validate_Config(bool Configtest, bool Rehash)
 	/* Validate configuration settings. */
 
 	int i, servers, servers_once;
+#ifndef NGIRCD_DISABLE_RESOLVER
 	struct hostent *h;
+#endif
 	bool config_valid = true;
 	char *ptr;
 #ifdef HAVE_SETRLIMIT
@@ -2131,13 +2150,15 @@ Validate_Config(bool Configtest, bool Rehash)
 		 * host name. Note: the IRC server name MUST contain
 		 * at least one dot, so the "node name" is not sufficient! */
 		gethostname(Conf_ServerName, sizeof(Conf_ServerName));
+#ifndef NGIRCD_DISABLE_RESOLVER
 		if (Conf_DNS) {
 			/* Try to get a proper host name ... */
 			h = gethostbyname(Conf_ServerName);
-			if (h)
+			if (h && h->h_name)
 				strlcpy(Conf_ServerName, h->h_name,
 					sizeof(Conf_ServerName));
 		}
+#endif
 		if (!strchr(Conf_ServerName, '.')) {
 			/* (Still) No dot in the name! */
 			strlcat(Conf_ServerName, ".host",
diff --git a/src/ngircd/conn.c b/src/ngircd/conn.c
index 68a901d0..f4dafa7d 100644
--- a/src/ngircd/conn.c
+++ b/src/ngircd/conn.c
@@ -40,6 +40,10 @@
 #include <time.h>
 #include <netinet/in.h>
 
+#ifdef __WATCOMC__
+extern int getsockopt(int, int, int, void *, unsigned int *);
+#endif
+
 #ifdef HAVE_NETINET_IP_H
 # ifdef HAVE_NETINET_IN_SYSTM_H
 #  include <netinet/in_systm.h>
@@ -1533,9 +1537,13 @@ Conn_StartLogin(CONN_ID Idx)
 			return;
 	}
 
+#ifndef NGIRCD_DISABLE_RESOLVER
 	Resolve_Addr_Ident(&My_Connections[Idx].proc_stat,
 			   &My_Connections[Idx].addr,
 			   ident_sock, cb_Read_Resolver_Result);
+#else
+	(void)ident_sock;
+#endif
 }
 
 /**
@@ -1993,9 +2001,24 @@ Check_Servers(void)
 		assert(Proc_GetPipeFd(&Conf_Server[i].res_stat) < 0);
 
 		/* Start resolver subprocess ... */
+#ifdef NGIRCD_DISABLE_RESOLVER
+		memset(&Conf_Server[i].dst_addr, 0,
+		       sizeof(Conf_Server[i].dst_addr));
+		if (!ng_ipaddr_init(&Conf_Server[i].dst_addr[0],
+				    Conf_Server[i].host,
+				    (UINT16)Conf_Server[i].port)) {
+			Log(LOG_WARNING,
+			    "Server \"%s\": Host \"%s\" is not a numeric address; skipping connection attempt.",
+			    Conf_Server[i].name, Conf_Server[i].host);
+			Conf_Server[i].conn_id = NONE;
+			continue;
+		}
+		New_Server(i, &Conf_Server[i].dst_addr[0]);
+#else
 		if (!Resolve_Name(&Conf_Server[i].res_stat, Conf_Server[i].host,
 				  cb_Connect_to_Server))
 			Conf_Server[i].conn_id = NONE;
+#endif
 	}
 } /* Check_Servers */
 
diff --git a/src/ngircd/resolve.c b/src/ngircd/resolve.c
index 25be58a4..f91576d2 100644
--- a/src/ngircd/resolve.c
+++ b/src/ngircd/resolve.c
@@ -42,6 +42,24 @@
 
 #include "resolve.h"
 
+#ifdef NGIRCD_DISABLE_RESOLVER
+
+GLOBAL bool
+Resolve_Addr_Ident(UNUSED PROC_STAT *s, UNUSED const ng_ipaddr_t *Addr,
+		   UNUSED int identsock, UNUSED void (*cbfunc)(int, short))
+{
+	return false;
+}
+
+GLOBAL bool
+Resolve_Name(UNUSED PROC_STAT *s, UNUSED const char *Host,
+	     UNUSED void (*cbfunc)(int, short))
+{
+	return false;
+}
+
+#else
+
 static void Do_ResolveAddr_Ident PARAMS(( const ng_ipaddr_t *Addr, int Sock, int w_fd ));
 static void Do_ResolveName PARAMS(( const char *Host, int w_fd ));
 
@@ -449,5 +467,7 @@ Do_ResolveName( const char *Host, int w_fd )
 	array_free(&IpAddrs);
 } /* Do_ResolveName */
 
+#endif /* NGIRCD_DISABLE_RESOLVER */
+
 
 /* -eof- */
diff --git a/src/portab/Makefile.ng b/src/portab/Makefile.ng
index 9be5f567..2df0a0bb 100644
--- a/src/portab/Makefile.ng
+++ b/src/portab/Makefile.ng
@@ -16,6 +16,7 @@ EXTRA_DIST = Makefile.ng
 noinst_LIBRARIES = libngportab.a
 
 libngportab_a_SOURCES = \
+	elks-stubs.c \
 	strdup.c \
 	strlcpy.c \
 	strndup.c \
diff --git a/src/portab/portab.h b/src/portab/portab.h
index e0ec3e1e..44c7f10b 100644
--- a/src/portab/portab.h
+++ b/src/portab/portab.h
@@ -35,6 +35,13 @@
 # define UNUSED
 #endif
 
+#ifdef __WATCOMC__
+# undef PUNUSED
+# undef UNUSED
+# define PUNUSED(x) x
+# define UNUSED
+#endif
+
 #ifndef PARAMS
 # if PROTOTYPES
 #  define PARAMS(args) args
diff --git a/src/portab/vsnprintf.c b/src/portab/vsnprintf.c
index d3b2a888..dc89285e 100644
--- a/src/portab/vsnprintf.c
+++ b/src/portab/vsnprintf.c
@@ -10,6 +10,7 @@
  */
 
 #include "portab.h"
+#include <ctype.h>
 
 /**
  * @file
diff --git a/src/portab/waitpid.c b/src/portab/waitpid.c
index 921dd3d6..08cc84f6 100644
--- a/src/portab/waitpid.c
+++ b/src/portab/waitpid.c
@@ -15,6 +15,7 @@
 #include <string.h>
 #include <stdlib.h>
 #include <sys/types.h>
+#include <sys/wait.h>
 
 GLOBAL int
 waitpid(pid, stat_loc, options)
